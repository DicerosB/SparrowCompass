/*
 * MotorDriver.cpp
 *
 *  Created on: Nov 25, 2025
 *      Author: Manue
 */
#include "main.h"
#include "MotorDriver.h"

MotorDriver::MotorDriver() {
	// TODO Auto-generated constructor stub

}
// step: number of steps
// speed: number of steps per second
// dir: direction of rotation
void spin(uint16_t steps, int speed, bool dir){
	// set direction
	HAL_GPIO_WritePin(MOT_DIR_GPIO_Port, MOT_DIR_Pin, dir);

	// enable motor
	HAL_GPIO_WritePin(MOT_nEnable_GPIO_Port, MOT_nEnable_Pin, GPIO_RESET);

	// generate PWM Bitbang
	double period = 1000/speed; // mili seconds per step

	for(uint16_t stp = 0; i < steps; stp++){
		HAL_GPIO_WritePin(MOT_STEP_GPIO_Port, MOT_STEP_Pin, GPIO_RESET);
		HAL_Delay(period/2);
		HAL_GPIO_WritePin(MOT_STEP_GPIO_Port, MOT_STEP_Pin, GPIO_RESET);
		HAL_Delay(period/2);

	}

}

